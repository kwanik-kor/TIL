> 2022년 10월 04일(화) 10:30 - Chapter 8

# Chapter 8. 스타일 가이드와 규칙

> 대부분의 엔지니어링 조직에서는 내부 코드베이스를 관리하는 규칙이 존재하고 이는 소스파일을 저장하는 위치, 코드 포맷팅
> , 명명 방식, 패턴, 예외와 스레드 사용법 등을 규정한다. 
> > 규칙: 제안이나 권장사항이 아닌, 엄격하고 꼭 지켜야 하는 법
> 
> > 지침: 권장사항과 모범사례로, 따를 것을 권하지만, 규칙과 달리 다소 변형하여 적용 가능하다.

---
### 8.1 규칙이 필요한 이유
> '좋은' 행동을 장려하고 '나쁜' 행동을 억제하기 위함.

1. 규칙을 정함에 있어 가장 중요한 것은 조직이 추구하는 가치를 파악해야 한다.
2. 규칙을 통해 **어휘**가 통일되면, 엔지니어들은 코드를 표현하는 **형식**보다 코드에 담을 **내용**에 집중할 수 있다.

---
### 8.2 규칙 만들기
> 규칙을 통해 어떤 목표를 이루려 하지? + 왜 이 내용이 스타일 가이드에 들어가야 하지?

#### 8.2.1 기본 원칙 안내
> 구글의 목표: 개발 환경의 복잡도를 관리하고 엔지니어들의 생산성을 희생하지 않는 선에서 코드베이스를 관리 가능하게끔 유지하는 것

#### **중요한 규칙**
1. 규칙의 양을 최소화한다.
   1. 모든 것을 넣어선 안된다.
   2. 규칙이 너무 많은 것도 **일종의 비용**이다!
2. 코드를 읽는 사람에게 맞춘다.
   1. 코드는 작성되는 횟수보다 읽히는 횟수가 더 많다.
   2. 엔지니어가 의도한 행위를 분명하게 알려주는 증거를 코드에 남기기로 했다.
   3. 행위가 헷갈리거나 오해할 수 있는 상황에서는 의도한 행위를 알려주는 근거가 더욱 중요함.
   4. **현 위치에서 추론하기**
      1. **문서화 주석** : 뒤따르는 코드의 설계나 의도를 설명
      2. **구현 주석** : 뻔하지 않은 선택을 한 이유를 해명하거나 주의할 점을 알려주거나, 까다로운 로직을 설명, 중요한 부분을 강조한다.
3. 일관되어야 한다.
   1. 익숙지 않은 부분을 살펴볼 일이 생겨도 상당히 빠르게 작업을 이어갈 수 있어야 한다.
   2. 일관된 코드는 '무엇을' 수행하느냐에 집중할 수 있음.
   3. 코드를 모듈화하거나 중복을 찾기도 쉽다.
   4. 이는 곧 **조직 확장**으로 연결된다.
   5. 일반적으로 규약은 바깥세상과 일관되게 잡는 편이 유리함.
4. 오류가 나기 쉽거나 예상치 못한 동작을 유발하는 구조를 피한다.
   1. 복잡한 기능에서는 언뜻 봐서는 지나칠 수 있는 미묘한 함정이 숨어있는 경우가 많음.
   2. 항상 고급 기능이 이상적인 해법으로 작용하지는 않는다.
5. 꼭 필요하다면 실용성을 생각해 예외를 허용한다.
   1. **어리석게 일관성만 고집한다면 편협한 홉고블린과 다를 바 없다.**
   2. 성능 및 상호운용성도 중요하다!
   
#### 8.2.2 스타일 가이드
> 위험을 피하기 위한 규칙, 모범 사례를 적용하기 위한 규칙, 일관성을 보장하기 위한 규칙

#### **위험 회피하기**
1. 기술적인 이유 때문에 반드시 써야 하거나 쓰면 안되는 언어 특성들에 관한 규칙들이 담겨 있음
2. 정적 멤버와 변수, 람다식, 예외 처리, 스레드와 접근 제어, 클래스 상속
3. 결론에 이르기까지 고려한 장점과 단점, 어디에 무게를 두었는지도 설명이 필요함

#### **모범 사례 강제하기**
1. 코드베이스를 건실하고 관리 가능하게 지켜줌
2. 코드 작성자가 주석을 어디에 어떻게 작성해야 하는지를 명시하는 것과 같음
   1. [자바 주석 사용 위치](https://google.github.io/styleguide/javaguide.html#s7-javadoc)
3. 소스코드의 가독성을 높이는 것에도 신경을 써야함.
   1. 대부분이 이 범주에 속함

#### **일관성 구축하기**
1. 사소한 문제를 다루는 경우도 많은데, 이는 단순히 결정을 내리고 그 결정을 문서로 남기는 것
2. 명명 규칙, 들여쓰기 공백 수, 임포트문 순서 같은 것

---
### 8.3 규칙 수정하기
> 스타일 가이드는 고정불변이 아니다. 세월의 흐름에 따른 기존 결정에 대한 요인들이 변하기 마련이다.

1. 규칙을 유용한 최신 상태로 유지하기 위해서는 업데이트가 필요한 규칙이 무엇인지 알아챌 수 있어야 한다.
   1. 이를 위해 결정에 뒷받침되는 근거를 명시해둔다.
   2. 근거가 문서화되어 있다면, 규칙을 변경해야 할 때가 언제인지를 알아내기 쉬워진다.

#### 8.3.1 프로세스
> 발견된 패턴을 기반으로 그리고 기존 결정에 대한 상세한 근거를 바탕으로 다른 결론에 도달할 수 있는지 평가한다.

#### 8.3.2 스타일 중재자
> 언어별로 소유자가 따로 있어 최종 결정과 승인을 책임지는 스타일 중재자가 존재한다.

#### 8.3.3 예외
> 스타일 가이드의 규칙은 법과 같지만 일부 규칙은 예외를 허용한다.

1. 규칙들은 더 범용적으로 쓰일 수 있도록 설계되는데, 특정 상황에서는 일부 규칙을 적용하지 않아도 되게끔 예외를 허용한다.
2. 규칙을 따르기보다 예외를 인정하는 쪽이 이득이라고 판단될 때만 예외를 허용한다.

---
### 8.4 지침
> 지침에는 복잡한 주제에 관한 길고 깊은 논의부터 권장하는 모범 사례에 관한 짧고 집중적인 조언까지 다양하다.
> > 구글의 엔지니어링 경험에서 선별한 지혜이자 과거로부터 배운 교훈들로부터 추린 모범 사례를 문서로 남긴 것

1. 주요 언어들의 입문서
   1. 가이드가 권장하는 기능을 자세하게 설명
   2. 모든 측면을 세세하게 파고들진 않지만, 권장하는 사용법을 알려줌
2. 가장 많이 쓰이는 라이브러리, 이디엄, 사내 기본 설정, 커스텀 도구 사용법 등을 알려준다.
   1. 올바로 구현하기 어려운 주제에 관한 언어별 조언
   2. 언어의 최신 버전에서 소개된 새로운 기능의 상세 설명과 구글 코드베이스에 적용하는 방법에 관한 조언
   3. 구글 라이브러리가 제공하는 중요한 추상 개념과 데이터 구조 목록

---
### 8.5 규칙 적용하기
> 규칙을 강제하는 방법으로는 교육과 훈련을 통한 사회적인 방법과 도구를 이용한 기술적인 방법이 있음

- 규칙을 인지하고 이해하도록 하기 위해 구글의 훈련 프로그램 중심에는 코드리뷰가 있음.
- 규칙이 실제로 지켜지는지를 확인하기 위해서는 사람보다는 되도록 자동화 도구를 사용함.

#### 8.5.1 오류 검사기
> 정적 분석 도구를 통해 언어 사용법과 관련한 규칙들의 상당수를 강제할 수 있음

#### 8.5.2 코드 포맷터
> 자동 스타일 검사기와 포맷터를 적극 이용함으로써, 구글의 코드 형식을 일관되게 관리한다.

- 프리서브밋 검사(Presubmit check)를 통해 포맷터를 반드시 사용하게 함.

